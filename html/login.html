<!DOCTYPE html>
<html lang="lucky">

<head>
    <title>学习课程计划辅助编排系统-Lucky</title>
    <!-- Meta tag Keywords -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8" />
    <meta name="keywords" content="学习课程计划辅助编排系统,选课,排课,lucky" />
    <!-- //Meta tag Keywords -->
    <link href="//fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!--/Style-CSS -->
    <link rel="stylesheet" href="../css/style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../css/register.css" type="text/css" media="all" />
    <!--//Style-CSS -->

    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css" media="all">
    <link rel="stylesheet" href="../iconfont/iconfont.css">
</head>

<body>

    <!-- form section start -->
    <section class="login-form">
        <h1>学习课程计划辅助编排系统</h1>  
        <div class="container">
            <!-- /form -->
            <div class="workinghny-form-grid">
                <div class="main">
                    <div class="content-wthree">
                        <h2>Log In</h2>
                        <form action="#" method="post">
                            <div class="item-user">
                                <div class="item-box username">
                                    <span class="iconfont icon-user"></span>
                                    <input type="text" class="text" name="username-login" placeholder="User Name" required="" autofocus autocomplete="off">
                                </div>
                                <span class="user-msg"></span>
                            </div>
                            <div class="item-psw">
                                <div class = "item-box pswtext">
                                    <span class="iconfont icon-tianchongxing-"></span>
                                    <input type="password" class="password" name="password-login" placeholder="User Password" required="" autofocus>
                               </div>
                                <span class="psw-msg"></span>
                            </div>
                            <div class="item-box check">
                                <input type="checkbox" id="rememberPassword">
                                <label for="rememberPassword" class="remember-label">记住密码</label>
                            </div>
                            <button class="btn" type="submit">Log In</button>
                        </form>
                        
                        <p class="account">Don't have an account? <a href="./register.html">Register</a></p>
                    </div>
                    <div class="w3l_form align-self">
                        <div class="left_grid_info">
                            <img src="../sources/images/1.png" alt="" class="img-fluid">
                        </div>
                    </div>
                </div>
            </div>
            <!-- //form -->
        </div>
        <!-- copyright-->
        <div class="copyright text-center">
            <p class="copy-footer-29">© 2023 Lucky-Report Login Form. All rights reserved</p>
        </div>
        <!-- //copyright-->
    </section>
    <!-- //form section start -->
</body>

<script>
    // const username = document.querySelector('input.text');
    // username.value="lucky";
    // console.log(username.value);
    const psw = document.querySelector('[name=password-login]');
    const uname = document.querySelector('[name=username-login]');
    const form = document.querySelector('form');
    const span = document.querySelector('.psw-msg');
    const oRemember = document.getElementById('rememberPassword');

    
    form.addEventListener('submit',function(e)
    {
        if(localStorage.getItem(uname.value)!==psw.value)
        {
            span.innerText = "密码错误";
            psw.value='';
            e.preventDefault(); // 阻止提交
        }
    })

    // 实现记住密码功能
    // 该用户记住密码，则自动填充密码
    psw.addEventListener('focus',function()
    {
        if (getCookie(uname.value)&&(uname.value!=='')) {
            psw.value = getCookie(uname.value);
            oRemember.checked = true;
        }
        //复选框勾选状态发生改变时，如果未勾选则清除cookie
        oRemember.onchange = function() {
            if (!this.checked) {
                delCookie(uname.value);
            }
        };
        //表单提交事件触发时，如果复选框是勾选状态则保存cookie
        form.onsubmit = function() {
            if (oRemember.checked) {
                setCookie(uname.value, psw.value, 365*30); //保存帐号到cookie，有效期30年
            }
        };
    })
    // 该用户记住密码 则勾选复选框
    uname.addEventListener('input',function()
    {
        if (getCookie(uname.value)&&(uname.value!=='')) {
            oRemember.checked = true;
        }else
        oRemember.checked = false;
    })

    // 页面加载刷新
    window.onload = function(){
        uname.value='';
        psw.value='';
        oRemember.checked = false;
    }

    //设置cookie
    function setCookie(name, value, day) {
        var date = new Date();
        date.setDate(date.getDate() + day);
        document.cookie = name + '=' + value + ';expires=' + date;
    };
    //获取cookie
    function getCookie(name) {
        var reg = RegExp(name + '=([^;]+)');
        var arr = document.cookie.match(reg);
        if (arr) {
            return arr[1];
        } else {
            return '';
        }
    };
    //删除cookie
    function delCookie(name) {
        setCookie(name, null, -1);
    };
</script>
</html>